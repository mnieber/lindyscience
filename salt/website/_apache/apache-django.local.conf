<VirtualHost *:80>

ServerName localhost
DocumentRoot {{ pillar['srv_dir'] }}

ProxyPass /static/ !
ProxyPass /media/ !
ProxyPass / http://localhost:8000/

<Location />
    AuthType Basic
    AuthName "Restricted Content"
    AuthUserFile /etc/apache2/.htpasswd
    Require valid-user
</Location>

<Directory "{{ pillar['srv_dir'] }}/static">
Options FollowSymLinks
Require all granted
</Directory>

<Directory "{{ pillar['srv_dir'] }}/media">
Options FollowSymLinks
Require all granted
</Directory>

</VirtualHost>
